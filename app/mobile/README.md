# Soter Mobile ðŸ“±

Mobile application for field operations and pilots, built with Expo and TypeScript.

## Features

- **Home Screen**: Overview and quick actions.
- **Health Screen**: Real-time system status monitoring with environment indicator.
- **Navigation**: Built with React Navigation.
- **Environment Support**: Uses `EXPO_PUBLIC_*` for configuration.

## Setup

1. **Install dependencies**:
   ```bash
   pnpm install
   ```

2. **Configure environment variables**:
   Copy `.env.example` to `.env`:
   ```bash
   cp .env.example .env
   ```
   Update `EXPO_PUBLIC_API_URL` to point to your backend.

3. **Start the app**:
   ```bash
   pnpm start
   ```

## Environment Variables

All Expo public variables are prefixed with `EXPO_PUBLIC_` and are safe to ship in any build â€” they contain no secrets.

| Variable | Required | Default | Description |
|---|---|---|---|
| `EXPO_PUBLIC_API_URL` | Yes | `http://localhost:3000` | Full URL of the backend API. Used by the Health Screen and the API service. |
| `EXPO_PUBLIC_ENV_NAME` | No | auto-inferred | Human-readable label shown in the Health Screen badge and footer (e.g. `dev`, `staging`, `prod`). |
| `EXPO_PUBLIC_NETWORK` | No | `testnet` | Blockchain network identifier. |

### `EXPO_PUBLIC_API_URL`

```bash
# Local development (iOS Simulator)
EXPO_PUBLIC_API_URL=http://localhost:3000

# Local development (Android Emulator)
EXPO_PUBLIC_API_URL=http://10.0.2.2:3000

# Physical device â€“ use your machine's LAN IP
EXPO_PUBLIC_API_URL=http://192.168.1.10:3000

# Staging / production
EXPO_PUBLIC_API_URL=https://api.staging.example.com
```

### `EXPO_PUBLIC_ENV_NAME` (optional)

Sets the coloured environment badge visible in the Health Screen header and footer.
If omitted, the label is **auto-inferred** from `EXPO_PUBLIC_API_URL`:

| URL contains | Inferred label | Badge colour |
|---|---|---|
| `prod` | `prod` | ðŸ”´ red |
| `staging` | `staging` | ðŸŸ  amber |
| anything else | `dev` | ðŸ”µ blue |

```bash
EXPO_PUBLIC_ENV_NAME=dev      # or staging, prod, or any custom name
```

> The badge and footer text are always visible (there are no secrets) so they are safe to leave in production builds.

## Health Screen

The Health Screen fetches backend health from `${EXPO_PUBLIC_API_URL}/health`.  
If the backend is unreachable it falls back to mock data.

The screen always shows a small **environment badge** (top-right of the header) and a **footer row** of the form:

```
Environment: dev Â· localhost:3000
```

This lets testers and field users confirm the API target without navigating to any settings page.

## Scripts

- `pnpm start`: Start Expo dev server with Metro bundler
- `pnpm android`: Run on Android emulator or device
- `pnpm ios`: Run on iOS simulator or device
- `pnpm web`: Run in web browser for testing
- `pnpm test`: Run Jest test suite
- `pnpm lint`: Run ESLint for code quality checks

## Troubleshooting

- **Connection refused**: If running on a physical device, ensure `EXPO_PUBLIC_API_URL` uses your machine's local IP address.
- **Metro not starting**: Try clearing the cache with `expo start -c`.
- **Wrong environment shown**: Verify `.env` contains the correct `EXPO_PUBLIC_ENV_NAME` or `EXPO_PUBLIC_API_URL`, then restart Metro (`expo start -c`).

For detailed development setup, testing procedures, and comprehensive troubleshooting, see [CONTRIBUTING.md](./CONTRIBUTING.md).
